<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=800, initial-scale=0.4, maximum-scale=2.0, user-scalable=yes">
  <title>برگه بیوگرافی</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    /* استایل پاپ‌آپ راهنما */
    #guide-modal {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.7);
      display: flex; justify-content: center; align-items: center;
      z-index: 1000;
    }
    .modal-content {
      background: #fff;
      padding: 25px;
      border-radius: 12px;
      width: 500px;
      max-width: 90%;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      text-align: right;
      line-height: 1.8;
    }
    .modal-content h3 { color: #2c3e50; margin-top: 0; border-bottom: 2px solid #eee; padding-bottom: 10px; }
    .btn-close-modal {
      background: #34495e; color: #fff; border: none; padding: 12px 25px;
      border-radius: 8px; cursor: pointer; font-family: Tahoma; font-weight: bold;
      width: 100%; margin-top: 15px; transition: 0.3s;
    }

    body {
      font-family: Tahoma, Arial, sans-serif;
      background: #eceff1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px 0;
      margin: 0;
    }

    #capture-area {
      background: #fff;
      width: 800px;
      padding: 20px;
      border: 2px solid #000;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      box-sizing: border-box;
    }

    table { width: 100%; border-collapse: collapse; border: 2px solid #000; }
    td { 
      border: 1px solid #000; 
      padding: 8px; 
      vertical-align: middle; 
      font-size: 14px; 
      line-height: 1.8; 
      text-align: right; 
      white-space: nowrap; 
    }
    
    .header-cell { text-align: center; font-weight: bold; font-size: 20px; padding: 15px; white-space: normal; }

    input[type="text"], textarea {
      border: none; outline: none; background: transparent;
      color: red; font-size: 15px; font-weight: bold; font-family: Tahoma, sans-serif;
      text-align: right; direction: rtl; width: auto; flex-grow: 1;
      line-height: 1.8; padding-bottom: 2px;
    }
    
    textarea { width: 100%; resize: none; overflow: hidden; display: block; white-space: normal; }
    tr[colspan] td, .footer-row td { white-space: normal; }

    /* دکمه‌ها و کنترلرها */
    .controls {
      margin-top: 30px;
      display: flex;
      justify-content: space-between; /* ایجاد فاصله بین دو گروه دکمه */
      width: 800px;
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      box-sizing: border-box;
      margin-bottom: 50px;
    }

    .btn-group { display: flex; gap: 12px; }

    button { 
      padding: 12px 20px; 
      cursor: pointer; 
      border: none; 
      border-radius: 8px; 
      font-family: Tahoma; 
      font-weight: bold; 
      font-size: 13px;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    button:active { transform: scale(0.96); }

    /* رنگ‌بندی جدید و کاربرپسند */
    .btn-backup { background: #78909c; color: #fff; } /* آبی خاکستری ملایم */
    .btn-restore { background: #90a4ae; color: #fff; } /* نسخه روشن‌تر برای بازیابی */
    
    .btn-share { background: #42a5f5; color: #fff; } /* آبی روشن تلگرامی */
    .btn-download { background: #66bb6a; color: #fff; } /* سبز ملایم */

    #fileInput { display: none; }
    .footer-row td { font-weight: bold; font-size: 19px; padding: 16px; white-space: normal; }
    
    #instagram { direction: ltr !important; text-align: left !important; unicode-bidi: plaintext !important; }
  </style>
</head>
<body>

  <div id="guide-modal">
    <div class="modal-content">
      <h3>راهنمای استفاده از فرم</h3>
      <ul>
        <li><strong>مرورگر:</strong> جهت عملکرد صحیح (به‌ویژه دکمه اشتراک‌گذاری)، حتماً از <strong>Chrome</strong> استفاده کنید.</li>
        <li><strong>پشتیبان و بازیابی:</strong> برای ذخیره موقت اطلاعات و بازگرداندن آن‌ها جهت ویرایش مجدد استفاده می‌شود.</li>
        <li><strong>ارسال و دانلود:</strong> خروجی نهایی فرم را به صورت عکس برای شما آماده می‌کنند.</li>
      </ul>
      <button class="btn-close-modal" onclick="closeModal()">متوجه شدم</button>
    </div>
  </div>

  <div id="capture-area">
    <table>
      <tr><td colspan="2" class="header-cell">برگه بیوگرافی</td></tr>
      <tr>
        <td width="48%"><div class="flex-row">نام و نام خانوادگی معرف: <input type="text" id="moaref_name"></div></td>
        <td width="52%"><div class="flex-row">نام و نام خانوادگی پراسپکت: <input type="text" id="prospect_name"></div></td>
      </tr>
      <tr>
        <td><div class="flex-row">ساعت دقیق و تاریخ پرزنت: <input type="text" id="present_date"></div></td>
        <td><div class="flex-row">سن پراسپکت: <input type="text" id="prospect_age"></div></td>
      </tr>
      <tr>
        <td><div class="flex-row">مکان پرزنت: <input type="text" id="present_location"></div></td>
        <td><div class="flex-row">نسبت با معرف: <input type="text" id="relation"></div></td>
      </tr>
      <tr>
        <td>
          <div class="flex-row">تحصیلات:
            <select id="education" class="answer-select">
              <option value="" disabled selected>انتخاب کنید</option>
              <option value="زیر دیپلم">زیر دیپلم</option>
              <option value="دیپلم">دیپلم</option>
              <option value="لیسانس">لیسانس</option>
              <option value="فوق لیسانس">فوق لیسانس</option>
              <option value="دکتری">دکتری</option>
              <option value="نمی‌دانم">نمی‌دانم</option>
            </select>
          </div>
        </td>
        <td><div class="flex-row">رشته تحصیلی: <input type="text" id="major"></div></td>
      </tr>
      <tr>
        <td>
          <div class="flex-row">وضعیت تأهل: 
            <select id="marriage" class="answer-select">
              <option value="" disabled selected>انتخاب کنید</option>
              <option value="مجرد">مجرد</option><option value="متأهل">متأهل</option>
              <option value="طلاق گرفته">طلاق گرفته</option><option value="همسر فوت کرده">همسر فوت کرده</option>
              <option value="نمی‌دانم">نمی‌دانم</option>
            </select>
          </div>
        </td>
        <td>
          <div class="flex-row">تعداد فرزند:
            <select id="children" class="answer-select">
              <option value="" disabled selected>انتخاب کنید</option>
              <option value="صفر">صفر</option><option value="۱">۱</option><option value="۲">۲</option>
              <option value="۳">۳</option><option value="۴">۴</option>
              <option value=" بیشتر از ۴">بیشتر از ۴</option><option value="نمی‌دانم">نمی‌دانم</option>
            </select>
          </div>
        </td>
      </tr>
      <tr><td colspan="2" style="white-space: normal;"><div class="flex-row">شغل فعلی و سابقه مشاغل قبلی: <input type="text" id="job_history"></div></td></tr>
      <tr><td colspan="2" style="white-space: normal;"><div class="flex-row">میزان درآمد: <input type="text" id="income"></div></td></tr>
      <tr class="merge-top">
        <td colspan="2" style="white-space: normal;"><div class="flex-row">دغدغه فعلی:
            <label class="checkbox-group">درآمد<input type="checkbox" id="d_daramad"></label>
            <label class="checkbox-group">زمان<input type="checkbox" id="d_zaman"></label>
            <label class="checkbox-group">پیشرفت<input type="checkbox" id="d_pishraft"></label>
            <label class="checkbox-group">امنیت شغلی<input type="checkbox" id="d_amniat"></label>
        </div></td>
      </tr>
      <tr class="merge-bottom"><td colspan="2" style="white-space: normal;"><div class="flex-row">توضیحات بیشتر: <input type="text" id="desc1"></div></td></tr>
      <tr class="merge-top">
        <td colspan="2" style="white-space: normal;"><div class="flex-row" style="flex-wrap:wrap;">ویژگی‌های شخصیتی:
            <label class="checkbox-group">اجتماعی<input type="checkbox" id="v_ejtemai"></label>
            <label class="checkbox-group">ریسک‌پذیر<input type="checkbox" id="v_risk"></label>
            <label class="checkbox-group">مستقل<input type="checkbox" id="v_mostaghel"></label>
            <label class="checkbox-group">مذهبی<input type="checkbox" id="v_mazhabi"></label>
            <label class="checkbox-group">رُک<input type="checkbox" id="v_rok"></label>
            <label class="checkbox-group">شکاک<input type="checkbox" id="v_shakak"></label>
            <label class="checkbox-group">رفیق‌باز<input type="checkbox" id="v_rafigh"></label>
        </div></td>
      </tr>
      <tr class="merge-bottom">
        <td colspan="2" style="white-space: normal;"><div class="flex-row">
            <label class="checkbox-group">خواستار تجربه‌های تازه<input type="checkbox" id="exp_new"></label>
            <label class="checkbox-group">اهمیت‌دهنده به حرف اطرافیان<input type="checkbox" id="atrafian"></label>
            توضیحات بیشتر: <input type="text" id="desc2">
        </div></td>
      </tr>
      <tr><td colspan="2" style="white-space: normal;"><div class="flex-row">سرگرمی‌های مورد علاقه: <input type="text" id="hobbies"></div></td></tr>
      <tr><td colspan="2" style="white-space: normal;"><div class="flex-row">میزان آشنایی با علم روز و بازاریابی شبکه‌ای: <input type="text" id="mlm_knowledge"></div></td></tr>
      <tr><td colspan="2" style="white-space: normal;"><div class="flex-row">تاریخ آخرین دیدار و علت دیدار: <input type="text" id="last_visit"></div></td></tr>
      <tr><td colspan="2" style="white-space: normal;"><div class="flex-row">آخرین خاطره مشترک: <input type="text" id="memory"></div></td></tr>
      <tr><td colspan="2" style="white-space: normal;"><div class="flex-row">نیازهای امروزه و بزرگترین اهداف: <input type="text" id="goals"></div></td></tr>
      <tr><td colspan="2" style="white-space: normal;"><div class="flex-row">چالش‌های زندگی: <input type="text" id="challenges"></div></td></tr>
      <tr><td colspan="2" style="white-space: normal;"><div class="flex
