<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=800">
  <title>برگه بیوگرافی</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    body {
      font-family: Tahoma, Arial, sans-serif;
      background: #f0f0f0;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      margin: 0;
    }

    #capture-area {
      background: #fff;
      width: 800px;
      padding: 20px;
      border: 2px solid #000;
    }

    table { width: 100%; border-collapse: collapse; border: 2px solid #000; }
    td { 
      border: 1px solid #000; 
      padding: 8px; 
      vertical-align: middle; 
      font-size: 14px; 
      line-height: 1.6; 
      text-align: right; 
    }
    
    .header-cell { text-align: center; font-weight: bold; font-size: 20px; padding: 15px; }

    input[type="text"], textarea {
      border: none; outline: none; background: transparent;
      color: red; font-size: 15px; font-weight: bold;
      font-family: Tahoma, sans-serif;
      text-align: right; direction: rtl;
      width: auto; flex-grow: 1;
      line-height: 1.8; padding-bottom: 2px;
    }
    
    textarea { width: 100%; resize: none; overflow: hidden; display: block; }

    .answer-select {
      border: none; outline: none; background: transparent;
      color: red; font-size: 15px; font-weight: bold;
      font-family: Tahoma, sans-serif;
      text-align: right; direction: rtl;
      appearance: none;
      background-image: url('data:image/svg+xml;utf8,<svg fill="%23ff0000" height="14" viewBox="0 0 24 24" width="14" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>');
      background-repeat: no-repeat;
      background-position: left center;
      padding-left: 20px;
      line-height: 1.8;
      cursor: pointer;
    }

    .flex-row { display: flex; align-items: center; gap: 5px; justify-content: flex-start; }
    
    /* استایل تیک‌ها برای نمایش صحیح در عکس */
    .checkbox-container {
      display: inline-flex;
      align-items: center;
      cursor: pointer;
      margin-left: 10px;
      gap: 4px;
    }

    .custom-box {
      width: 18px;
      height: 18px;
      border: 1.5px solid #333;
      border-radius: 3px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #fff;
      color: transparent; /* در حالت عادی تیک مخفی است */
      font-size: 14px;
      font-weight: bold;
      transition: 0.2s;
    }

    /* وقتی چک‌باکس واقعی تیک بخورد، باکس نمایشی قرمز می‌شود */
    input[type="checkbox"]:checked + .custom-box {
      color: red;
      border-color: red;
    }

    /* مخفی کردن چک‌باکس اصلی */
    input[type="checkbox"] {
      display: none;
    }

    .controls {
      margin-top: 20px; display: flex; gap: 10px; background: #fff;
      padding: 15px; border-radius: 8px; width: 800px; justify-content: center;
    }

    button { padding: 10px 20px; cursor: pointer; border: none; border-radius: 5px; font-family: Tahoma; font-weight: bold; }
    .btn-download { background: #27ae60; color: #fff; }
    .btn-backup { background: #2980b9; color: #fff; }
    .btn-restore { background: #f39c12; color: #fff; }
    
    #instagram { direction: ltr; text-align: left; }
  </style>
</head>
<body>

  <div id="capture-area">
    <table>
      <tr><td colspan="2" class="header-cell">برگه بیوگرافی</td></tr>
      <tr>
        <td width="50%"><div class="flex-row">نام و نام خانوادگی معرف: <input type="text" id="moaref_name"></div></td>
        <td width="50%"><div class="flex-row">نام و نام خانوادگی پراسپکت: <input type="text" id="prospect_name"></div></td>
      </tr>
      <tr>
        <td><div class="flex-row">ساعت دقیق و تاریخ پرزنت: <input type="text" id="present_date"></div></td>
        <td><div class="flex-row">سن پراسپکت: <input type="text" id="prospect_age"></div></td>
      </tr>
      <tr>
        <td><div class="flex-row">مکان پرزنت: <input type="text" id="present_location"></div></td>
        <td><div class="flex-row">نسبت با معرف: <input type="text" id="relation"></div></td>
      </tr>
      <tr>
        <td>
          <div class="flex-row">تحصیلات:
            <select id="education" class="answer-select">
              <option value="">انتخاب کنید</option>
              <option value="زیر دیپلم">زیر دیپلم</option>
              <option value="دیپلم">دیپلم</option>
              <option value="لیسانس">لیسانس</option>
              <option value="فوق لیسانس">فوق لیسانس</option>
              <option value="دکتری">دکتری</option>
            </select>
          </div>
        </td>
        <td><div class="flex-row">رشته تحصیلی: <input type="text" id="major"></div></td>
      </tr>
      <tr>
        <td>
          <div class="flex-row">وضعیت تأهل: 
            <select id="marriage" class="answer-select">
              <option value="">انتخاب کنید</option>
              <option value="مجرد">مجرد</option>
              <option value="متأهل">متأهل</option>
              <option value="مطلقه">مطلقه</option>
              <option value="بیوه">بیوه</option>
            </select>
          </div>
        </td>
        <td>
          <div class="flex-row">تعداد فرزند:
            <select id="children" class="answer-select">
              <option value="۰">۰</option><option value="۱">۱</option><option value="۲">۲</option>
              <option value="۳">۳</option><option value="۴">۴</option><option value="۵">۵</option>
            </select>
          </div>
        </td>
      </tr>
      <tr><td colspan="2"><div class="flex-row">شغل فعلی و سابقه مشاغل قبلی: <input type="text" id="job_history"></div></td></tr>
      <tr><td colspan="2"><div class="flex-row">میزان درآمد: <input type="text" id="income"></div></td></tr>

      <tr>
        <td colspan="2">
          <div class="flex-row">دغدغه فعلی:
            <label class="checkbox-container">درآمد <input type="checkbox" id="d_daramad"><span class="custom-box">✔</span></label>
            <label class="checkbox-container">زمان <input type="checkbox" id="d_zaman"><span class="custom-box">✔</span></label>
            <label class="checkbox-container">پیشرفت <input type="checkbox" id="d_pishraft"><span class="custom-box">✔</span></label>
            <label class="checkbox-container">امنیت شغلی <input type="checkbox" id="d_amniat"><span class="custom-box">✔</span></label>
          </div>
        </td>
      </tr>
      <tr><td colspan="2"><div class="flex-row">توضیحات بیشتر: <input type="text" id="desc1"></div></td></tr>

      <tr>
        <td colspan="2">
          <div class="flex-row" style="flex-wrap:wrap;">ویژگی‌های شخصیتی:
            <label class="checkbox-container">اجتماعی <input type="checkbox" id="v_ejtemai"><span class="custom-box">✔</span></label>
            <label class="checkbox-container">ریسک‌پذیر <input type="checkbox" id="v_risk"><span class="custom-box">✔</span></label>
            <label class="checkbox-container">مستقل <input type="checkbox" id="v_mostaghel"><span class="custom-box">✔</span></label>
            <label class="checkbox-container">مذهبی <input type="checkbox" id="v_mazhabi"><span class="custom-box">✔</span></label>
            <label class="checkbox-container">رُک <input type="checkbox" id="v_rok"><span class="custom-box">✔</span></label>
            <label class="checkbox-container">شکاک <input type="checkbox" id="v_shakak"><span class="custom-box">✔</span></label>
          </div>
        </td>
      </tr>
      <tr><td colspan="2"><div class="flex-row">آخرین خاطره مشترک: <input type="text" id="memory"></div></td></tr>
      <tr><td colspan="2"><div class="flex-row">آدرس اینستاگرام: <input type="text" id="instagram"></div></td></tr>
      <tr><td colspan="2" style="height:100px; vertical-align:top;">توضیحات باقیمانده: <textarea id="final_desc" rows="3"></textarea></td></tr>
      
      <tr class="footer-row">
        <td colspan="2">
          اینجانب ( <input type="text" id="footer_me" style="width:120px;"> ) درخواست تأییدیه جهت زنگ دعوت...
        </td>
      </tr>
    </table>
  </div>

  <div class="controls">
    <button class="btn-backup" onclick="saveBackup()">پشتیبان</button>
    <button class="btn-restore" onclick="document.getElementById('fileInput').click()">بازیابی</button>
    <button class="btn-download" onclick="downloadJPG()">دانلود JPG</button>
    <input type="file" id="fileInput" accept=".json" onchange="restoreBackup(event)">
  </div>

  <script>
    function downloadJPG(){
      const el = document.getElementById('capture-area');
      html2canvas(el, {
        scale: 3, 
        useCORS: true,
        backgroundColor: '#ffffff'
      }).then(canvas => {
        const a = document.createElement('a');
        a.download = 'biography.jpg';
        a.href = canvas.toDataURL('image/jpeg', 0.95);
        a.click();
      });
    }

    function saveBackup(){
      const data={};
      document.querySelectorAll('input, textarea, select').forEach(el=>{
        data[el.id] = (el.type==='checkbox') ? el.checked : el.value;
      });
      const blob=new Blob([JSON.stringify(data)],{type:'application/json'});
      const a=document.createElement('a');
      a.href=URL.createObjectURL(blob); a.download='backup.json'; a.click();
    }

    function restoreBackup(e){
      const reader=new FileReader();
      reader.onload=(ev)=>{
        const data=JSON.parse(ev.target.result);
        for(const id in data){
          const el=document.getElementById(id);
          if(el) {
            if(el.type==='checkbox') el.checked=data[id];
            else el.value=data[id];
          }
        }
      };
      reader.readAsText(e.target.files[0]);
    }
  </script>
</body>
</html>
